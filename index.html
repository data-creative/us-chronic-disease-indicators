<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>US Chronic Disease Indicators</title>
    <link href='https://api.tiles.mapbox.com/mapbox.js/v2.1.4/mapbox.css' rel='stylesheet' />
    <script src='https://api.tiles.mapbox.com/mapbox.js/v2.1.4/mapbox.js'></script>
    <script src='https://www.mapbox.com/mapbox.js/assets/data/us-states.js'></script>
    <script src='/assets/colorbrewer.v1.min.js'></script>
  </head>
  <body>
    <h1>US Chronic Disease Indicators</h1>

    <select id="year-selector" title="Select a year or year range">
      <option value="2013" selected="selected">2013</option>
    </select>
    <select id="indicator-selector" title="Select an indicator">
      <option value="MTH1_0" selected="selected" >MTH1_0 - Recent mentally unhealthy days among adults aged â‰¥18 years</option>
    </select>
    <select id="gender-selector" title="Select a gender">
      <option value="GENT" selected="selected">Total</option>
      <option value="GENM">Male</option>
      <option value="GENF">Female</option>
    </select>
    <button id="map-requestor" title="Refresh map based on selections">Update</button>

    <div id="map-container" style="height:40em; border:1px solid #000; margin-bottom:2em;"></div>
    <div id="map-footer"><p>Some foot notes.</p></div>

    <script type="text/javascript">

        // CREATE BLANK MAP

        L.mapbox.accessToken = 'pk.eyJ1IjoiczJ0MiIsImEiOiJQVFE0UW1JIn0.0MfEvAJVxFx7BLGoL0USXA'
        var mapbox_map_id = 'mapbox.streets'
        var map_center = [52.26815737376817, -64.3359375]
        var map_zoom = 3
        var map = L.mapbox.map('map-container', mapbox_map_id, {scrollWheelZoom:false})
            .setView(map_center, map_zoom)
            //.on("click", logMapClick)
            //.on("dragend", logMapView)
            //.on("zoomend", logMapView)

        // DRAW STATE BOUNDARIES

        var states_bounds = []

        var state_name = "Connecticut"
        // statesData comes from https://www.mapbox.com/mapbox.js/assets/data/us-states.js
        var state_geojson_features = statesData.features.filter(function(feature){return feature.properties.name == state_name})
        if(state_geojson_features.length > 0){
            var state_geojson_feature = state_geojson_features[0]
            //var state_name = state_geojson_feature.properties.name
            var geojson_options = {
                style: {
                    fillColor: "#ccc", // colorScale(state_measure_value),
                    color: "#eee", // colorScale(state_measure_value),
                    weight: 2,
                    opacity: .5, // opacityScale(state_measure_value),
                    fillOpacity: .5, // opacityScale(state_measure_value),
                    className: 'geojson state ' + state_name
                }
            }
            var state = L.geoJson(state_geojson_feature, geojson_options)
            //var popup_content = generatePopupContent(d, state_name)
            //state.bindPopup(popup_content)
            map.addLayer(state)

            var state_bounds = state.getBounds()
            states_bounds.push(state_bounds)
        } // end if

        console.log(states_bounds)
        map.fitBounds(states_bounds)

    </script>
  </body>
</html>
